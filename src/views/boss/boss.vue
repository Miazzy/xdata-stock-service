<template>
<div class="boss">
    <div class="search-bar">
        <form action="/people_search">
            <div class="search-bar-input">
                <input type="text" value="某领导" class="searchkey" placeholder="请输入老板、股东、高管姓名" id="searchkey" name="key" required="required" autocomplete="off">
                <input type="submit" class="searchbtn" value="搜索">
                <a href="javascript:;" onclick="clearSearch()" id="searchClear" class="search-clear" style="display: inline;">
                </a>
            </div>
        </form>
    </div>
    <div class="psearch-content" id="psearchContent" style="margin-bottom:30px;">
        <div class="psearch-list">
            <div class="boss-wrap"> 
                <a href="/pl/p82d188575e6c0e482a90441415d5ae7.html">
                    <div class="boss" style="display:block;height:32px;">
                        <div class="pull-left">
                            <span class="boss-letter color-1" first-letter="张"></span>
                        </div>
                        <div class="pull-left" style="width:80%;">
                            <div class="boss-name m-l-sm">张某某</div>
                            <div class="boss-des m-l-sm">共任职 <span class="text-danger">7</span> 家企业，主要分布：</div>
                        </div>
                    </div>
                    <div class="boss-province-info" style="display:block;margin-top:10px;padding-top:10px;">
                        <div class="" style="margin-top:10px;margin-bottom: 5px;">
                            <div class="" style="width: 99%">
                                <div>四川（共<span class="text-danger">5</span>家）
                                    某某集团有限公司…等
                                </div>
                            </div>
                        </div>
                        <div class="" style="margin-bottom: 5px;">
                            <div class="" style="width: 99%">
                                <div>西藏（共<span class="text-danger">1</span>家）
                                    某某管理有限公司
                                </div>
                            </div>
                        </div>
                        <div class="" style="margin-bottom: 5px;">
                            <div class="" style="width: 99%">
                                <div>云南（共<span class="text-danger">1</span>家）
                                    某某矿业有限公司
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="boss-partner">
                        <div class="boss-partner-tip">其他合作伙伴</div>
                        <div class="boss-partner-scroll">
                            <object class="clearfix" style="display: block; width: 1150px;">
                                <a href="/pl/pc3e5ea54891bad17f32f09ec0039d8c.html" class="partner-warp"> <span class="partner-letter color-9" first-letter="程"></span> <object><a class="partner-name">程某金</a></object>
                                    <object> <a class="partner-com" href="/firm/f50d972bf1d7aa5bb88da915da782762.html">
                                            某某集团有限公司
                                        </a>
                                    </object> </a>
                                <a href="/pl/p47d164306807d70ba5d219a5616d904.html" class="partner-warp"> <span class="partner-letter color-3" first-letter="刘"></span> <object><a class="partner-name">刘某旺</a></object>
                                    <object> <a class="partner-com" href="/firm/84d59ed45e7120c3283d79b37bba3258.html">
                                            某某集团有限公司
                                        </a>
                                    </object> </a>
                                <a href="/pl/pa623216b83c08894d124afed076d1ef.html" class="partner-warp"> <span class="partner-letter color-6" first-letter="李"></span> <object><a class="partner-name">李某玉</a></object>
                                    <object> <a class="partner-com" href="/firm/f50d972bf1d7aa5bb88da915da782762.html">
                                            某某集团有限公司
                                        </a>
                                    </object> </a>
                            </object>
                        </div>
                    </div>
                </a>
            </div>
            <div class="boss-wrap"> 
                <a href="/pl/p82d188575e6c0e482a90441415d5ae7.html">
                    <div class="boss" style="display:block;height:32px;">
                        <div class="pull-left">
                            <span class="boss-letter color-1" first-letter="程"></span>
                        </div>
                        <div class="pull-left" style="width:80%;">
                            <div class="boss-name m-l-sm">程某</div>
                            <div class="boss-des m-l-sm">共任职 <span class="text-danger">7</span> 家企业，主要分布：</div>
                        </div>
                    </div>
                    <div class="boss-province-info" style="display:block;margin-top:10px;padding-top:10px;">
                        <div class="" style="margin-top:10px;margin-bottom: 5px;">
                            <div class="" style="width: 99%">
                                <div>四川（共<span class="text-danger">5</span>家）
                                    某某集团有限公司…等
                                </div>
                            </div>
                        </div>
                        <div class="" style="margin-bottom: 5px;">
                            <div class="" style="width: 99%">
                                <div>西藏（共<span class="text-danger">1</span>家）
                                    某某有限责任公司
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="boss-partner">
                        <div class="boss-partner-tip">其他合作伙伴</div>
                        <div class="boss-partner-scroll">
                            <object class="clearfix" style="display: block; width: 1150px;">
                                <a href="/pl/pc3e5ea54891bad17f32f09ec0039d8c.html" class="partner-warp"> <span class="partner-letter color-9" first-letter="游"></span> <object><a class="partner-name">游某某</a></object>
                                    <object> <a class="partner-com" href="/firm/f50d972bf1d7aa5bb88da915da782762.html">
                                            某某集团有限公司
                                        </a>
                                    </object> </a>
                                <a href="/pl/p47d164306807d70ba5d219a5616d904.html" class="partner-warp"> <span class="partner-letter color-3" first-letter="令狐"></span> <object><a class="partner-name">令狐某</a></object>
                                    <object> <a class="partner-com" href="/firm/84d59ed45e7120c3283d79b37bba3258.html">
                                            某某集团有限公司
                                        </a>
                                    </object> </a>
                                <a href="/pl/pa623216b83c08894d124afed076d1ef.html" class="partner-warp"> <span class="partner-letter color-6" first-letter="刘"></span> <object><a class="partner-name">刘某某</a></object>
                                    <object> <a class="partner-com" href="/firm/f50d972bf1d7aa5bb88da915da782762.html">
                                            某某集团有限公司
                                        </a>
                                    </object> </a>
                            </object>
                        </div>
                    </div>
                </a>
            </div>
        </div>
    </div>
    <div style="height:100px;"></div>
    <tabbar></tabbar>
</div>
</template>

<script>
import {
    ref,
    reactive,
    onMounted,
    toRefs,
    getCurrentInstance
} from "vue";
import {
    useStore
} from "vuex";
import {
    useRouter,
    useRoute
} from "vue-router";
import tabbar from "@/components/tabbar";
export default {
    name: "home",
    components: {
        tabbar
    },
    setup(props, context) {
        const {
            ctx
        } = getCurrentInstance();
        const $store = useStore(); // ctx.$store === $store  ==>true 其实是同一个对象！
        const $router = useRouter();
        const $route = useRoute(); // 可以拿到所有和路由相关的参数
        const active = ref("");
        const timeData = ref(36000000);
        const headerActive = ref(false);

        const state = reactive({
            homeImgs: [],
            tabArray: []
        });

        const ball = reactive({
            show: false,
            el: ""
        });

        ctx.$http.get("http://test.happymmall.com/home/homeData").then(res => {
            const {
                images,
                tabList
            } = res.data;
            state.tabArray = tabList;
            state.homeImgs = images;
        });

        onMounted(() => {
            window.addEventListener("scroll", pageScroll);
        });

        const addToCart = (event, tag) => {
            $store.commit("cart/addToCart", tag);
            ball.show = true;
            ball.el = event.target;
        };

        const beforeEnter = el => {
            const dom = ball.el;
            const rect = dom.getBoundingClientRect();
            const x = rect.left - window.innerWidth * 0.6;
            const y = -(window.innerHeight - rect.top);
            el.style.display = "block";
            el.style.transform = `translate3d(0,${y}px,0)`;
            const inner = el.querySelector(".inner");
            inner.style.transform = `translate3d(${x}px,0,0)`;
        };

        const enter = (el, done) => {
            document.body.offsetHeight;
            el.style.transform = "translate3d(0,0,0)";
            const inner = el.querySelector(".inner");
            inner.style.transform = "translate3d(0,0,0)";
            el.addEventListener("transitionend", done);
        };

        const afterEnter = el => {
            ball.show = false;
            el.style.display = "none";
        };

        const handleClick = linkUrl => {
            $router.push("/classify/product");
        };

        const pageScroll = () => {
            const scrollTop =
                window.pageYOffset ||
                document.documentElement.scrollTop ||
                document.body.scrollTop;
            scrollTop > 100 ?
                (headerActive.value = true) :
                (headerActive.value = false);
        };

        return {
            active,
            timeData,
            headerActive,
            ...toRefs(ball),
            ...toRefs(state),
            addToCart,
            beforeEnter,
            enter,
            afterEnter,
            handleClick,
            pageScroll
        };
    }
};
</script>

<style lang="scss" scoped>
@import "./boss.css";
</style>
